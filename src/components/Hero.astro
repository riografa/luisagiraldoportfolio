---
/* Hero.astro */
---

<section class="relative w-screen h-screen flex flex-col justify-end items-center overflow-hidden">
  <div id="model-3d-container" class="absolute inset-0 w-full h-full z-0"></div>

  <div class="relative w-full h-auto z-10 flex flex-col gap-2 p-2 text-center pb-8 text-gray-800">
    <h1 class="text-2xl lg:text-5xl font-bold">
      Luisa Fernanda Giraldo Murillo
    </h1>
    <p class="pb-8">
      Magíster Interdisciplinar en Teatro y Artes Vivas y estudiante del Doctorado en Arte y Arquitectura
    </p>
  </div>
</section>

<script type="module">
  
  const { initGLBScene } = await import(
    new URL('/src/scripts/load-glb-model.js', import.meta.env.BASE_URL).href
  );

  (async () => {
    const container = document.getElementById('model-3d-container');
    if (!container) {
      console.error('[Hero] ❌ No se encontró el contenedor');
      return;
    }

    // Ajusta tamaño del contenedor para el modelo
    container.style.width = '100vw';
    container.style.height = '100vh';

    try {
      // ✅ Ruta dinámica que respeta el base del sitio (importante para GitHub Pages)
      const modelPath = new URL('/models/mapa-colombia.glb', import.meta.env.BASE_URL).href;
      const scene = await initGLBScene(container, modelPath);
      window.threeScene = scene;
    } catch (err) {
      console.error('[Hero] ❌ Error al inicializar escena 3D:', err);

      const errorEl = document.createElement('div');
      errorEl.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255, 0, 0, 0.95);
        color: white;
        padding: 25px;
        border-radius: 10px;
        text-align: left;
        z-index: 100;
        max-width: 90%;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        line-height: 1.4;
        border: 2px solid #ff6b6b;
      `;
      errorEl.innerHTML = `
        <h3 style="margin: 0 0 15px 0; color: #ffcccb;">❌ Error cargando modelo 3D</h3>
        <p><strong>Error:</strong> ${err.message}</p>
        <hr style="margin: 15px 0; border: 1px solid rgba(255,255,255,0.3);">
        <p><strong>Verifica que el archivo exista en:</strong><br><code>/public/models/mapa-colombia.glb</code></p>
        <hr style="margin: 15px 0; border: 1px solid rgba(255,255,255,0.3);">
        <p><strong>✅ Checklist:</strong></p>
        <ol style="margin: 10px 0; padding-left: 20px;">
          <li>Archivo existe en <code>/public/models/mapa-colombia.glb</code></li>
          <li>Archivo no está corrupto</li>
          <li>Deploy exitoso en GitHub Pages</li>
        </ol>
      `;
      container.appendChild(errorEl);
    }
  })();

  // Limpieza opcional de la escena Three.js al salir
  window.addEventListener('beforeunload', () => {
    const scene = window.threeScene;
    if (scene && scene.dispose) {
      scene.dispose();
    }
  });
</script>
