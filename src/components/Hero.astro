---
// Hero.astro
---

<section class="relative w-screen h-screen flex flex-col justify-end items-center overflow-hidden">
  <div id="model-3d-container" class="absolute inset-0 w-full h-full z-0"></div>

  <div class="relative w-full h-auto z-10 flex flex-col gap-2 p-2 text-center pb-8 text-gray-800">
    <h1 class="text-2xl lg:text-5xl font-bold">
      Luisa Fernanda Giraldo Murillo
    </h1>
    <p class="pb-8">
      Magíster Interdisciplinar en Teatro y Artes Vivas y estudiante del Doctorado en Arte y Arquitectura
    </p>
  </div>
</section>

<script type="module">
  // ✅ Usar import relativo
  import { initGLBScene } from '../scripts/load-glb-model.js';

  (async () => {
    const container = document.getElementById('model-3d-container');
    console.log('[Hero] Container encontrado:', !!container);
    
    if (!container) {
      console.error('[Hero] No se encontró el contenedor');
      return;
    }

    container.style.position = 'fixed';
    container.style.top = '0';
    container.style.left = '0';
    container.style.width = '100vw';
    container.style.height = '100vh';
    container.style.zIndex = '0';

    console.log('[Hero] Contenedor configurado');

    try {
      // ✅ Usar import.meta.env.BASE_URL (funciona tanto en dev como en prod)
      const basePath = import.meta.env.BASE_URL;
      const modelPath = `${basePath}models/mapa-colombia.glb`;
      
      console.log('[Hero] BASE_URL:', basePath);
      console.log('[Hero] Model path:', modelPath);
      console.log('[Hero] Full URL:', window.location.origin + modelPath);
      
      const scene = await initGLBScene(container, modelPath);
      window.threeScene = scene;
      
      console.log('[Hero] ✅ Escena 3D cargada exitosamente');
      console.log('[Hero] Animaciones:', scene.animations?.length || 0);
      
    } catch (err) {
      console.error('[Hero] ❌ Error:', err);
      
      const errorEl = document.createElement('div');
      errorEl.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255, 0, 0, 0.95);
        color: white;
        padding: 25px;
        border-radius: 10px;
        z-index: 100;
        max-width: 600px;
        font-family: monospace;
      `;
      
      errorEl.innerHTML = `
        <h3 style="margin: 0 0 15px 0;">❌ Error cargando modelo 3D</h3>
        <p><strong>Error:</strong> ${err.message}</p>
        <p><strong>Buscando en:</strong><br>${window.location.origin + import.meta.env.BASE_URL}models/mapa-colombia.glb</p>
      `;
      container.appendChild(errorEl);
    }
  })();
</script>
